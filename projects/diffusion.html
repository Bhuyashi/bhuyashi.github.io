<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating a Realistic Donut in Blender</title>
    <link rel="icon" type="image/png" href="../favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="../favicon/favicon.svg" />
    <link rel="shortcut icon" href="../favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="../favicon/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Bhuyashi" />
    <link rel="manifest" href="../favicon/site.webmanifest" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../styles/project_style.css" />
    <script>
        MathJax = {
          tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
          }
        };
      </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
</head>
<body>

<nav>
    <div class="nav-container">
        <div class="title">
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
                <i class="fas fa-moon" id="theme-icon"></i>
            </button>
            <a href="../index.html" class="title">Homepage</a>
        </div>
    </div>
</nav>

    <section id="project-title" class="fade-up">
        <div>
            <h1>Diffusion Model for Image Synthesis</h1>
            <div class="project-meta">
                <span>October 2024</span>
                <span>|</span>
                <span class="tag" data-tag="computer-vision">Computer vision</span>
                <span class="tag" data-tag="diffusion">Diffusion</span>
            </div>
            <img src="../images/projects/diffusion.png" alt="Blender Donuts" style="width: 100%; max-width: 600px; height: auto; margin-top: 1em;">
        </div>
    </section>

<div class="main-content">
    <section id="project-content" class="fade-up">
        <div>
            <h2>Overview</h2>
            <p>
                In this project, I implemented the DDPM diffusion model from scratch using PyTorch.
                Diffusion models are generative models that create images by iteratively denoising a noisy image.
                It has a forward process that gradually adds noise to an image, creating intermediate images, 
                until it becomes complete gaussian noise $\mathcal N(0,1)$.
                In the reverse process, we try to recover the original image using the intermediate images as an anchor.
                The image below, taken from the DDPM paper, demonstrates this.
            </p>
            <div style="text-align: center; margin: 2em 0;">
                <img src="../images/projects/DDPM_forward_bkwrd_process.png" alt="DDPM Forward and Reverse Process" style="width: 100%; max-width: 700px; height: auto; border-radius: 8px; box-shadow: 0 2px 12px rgba(0,0,0,0.08);">
                <div style="font-size: 0.95em; color: #666; margin-top: 0.5em;">
                    <em>Figure: The forward (noising) and reverse (denoising) processes</em>
                </div>
            </div>

            <h2>Math</h2>
            <p>Before diving into the code, I wanted to understand the math behind the diffusion process.</p>
            
            <h2>Implementation Details</h2>
            <p>I used the PyTorch library to implement the DDPM model. I also used the torchvision library to load the datasets.</p>
            
            <h2>Results</h2>
            <p>To add the sprinkles, I used the particle system to distribute them naturally across the icing surface. The trick was getting the right density—too many and it looked artificial, too few and it lacked visual interest. I also varied the colors and sizes slightly to mimic real sprinkles.</p>

            <h2>Conclusion</h2>
            <p>For the final presentation, lighting was key. I added a red and blue light on the sides of the donuts such that they complimented the colors of the donuts and highlighted the sprinkles.</p>

            <h2>Looking Forward</h2>
            <p>I used Cycles renderer for photorealistic results, though it required longer render times. The payoff was worth it. The subsurface scattering, realistic shadows, and accurate light behavior made the final image look incredibly convincing.</p>
            
            <p>In post-processing, I made subtle adjustments to color balance and contrast, ensuring the donut looked warm and inviting without being oversaturated.</p>

            <h2>Future Improvements</h2>
            <p>This project taught me that 3D modeling is as much about observation as it is about technical skill. It makes a difference to study how light interacts with the glaze, how the surface imperfections catch the light, and how the colors vary slightly across the surface.</p>
            
            <p>And that the devil is in the details. A slight adjustment to the subsurface scattering settings could make the difference between plastic-looking icing and something that actually appeared edible.</p>

            <h2>References</h2>
            <p>Below is a video showcasing the final donut setup, demonstrating the various angles and lighting conditions:</p>
            
            <video controls width="100%" style="margin: 2em 0;">
                <source src="../videos/Blender_recording.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>

            <h2>Looking Forward</h2>
            <p>What started out as a project to learn Blender, developed into having an eye for detail and understanding how to translate real-world observations into digital art.</p>
            
            <p>The donut tutorial is often joked about in the 3D community, but there's a reason it's so popular. It covers all the fundamental concepts: modeling, texturing, lighting, and rendering. More importantly, it teaches you to see the world in terms of geometry, materials, and light.</p>

            <p>As I move forward with my VR project, I look forward to creating fun and complex puzzles that look realistic and immersive.</p>
        </div>
    </section>
</div>

<section id="github" class="fade-up">
    <div>
        <p><a href="https://github.com/Bhuyashi/donut_blender" target="_blank"><b>View the project on GitHub →</b></a></p>
    </div>
</section>

<script>
    // Theme initialization - inherit from main page
    const currentTheme = localStorage.getItem('theme') || 'dark';
    document.body.setAttribute('data-theme', currentTheme);

    // Update icon based on current theme
    const themeIcon = document.getElementById('theme-icon');
    if (currentTheme === 'dark') {
        themeIcon.className = 'fas fa-sun';
    } else {
        themeIcon.className = 'fas fa-moon';
    }

    // Theme toggle event listener
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle.addEventListener('click', () => {
        const current = document.body.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        document.body.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        themeIcon.className = next === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    });

    // Intersection Observer setup
    const observerOptions = {
        root: null,
        rootMargin: '0px',
        threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                observer.unobserve(entry.target); // Stop observing once animation is triggered
            }
        });
    }, observerOptions);

    // Get all elements with fade-up class
    const fadeElements = document.querySelectorAll('.fade-up');

    // Start observing each element
    fadeElements.forEach(element => {
        observer.observe(element);
    });

    // Tag click navigation functionality
    function initTagHandlers() {
        const tags = document.querySelectorAll('.tag');
        tags.forEach(tag => {
            tag.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const tagName = this.getAttribute('data-tag');
                if (tagName) {
                    window.location.href = `../tag.html?tag=${encodeURIComponent(tagName)}`;
                }
            });
        });
    }
    
    // Initialize tag handlers when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initTagHandlers);
    } else {
        initTagHandlers();
    }
</script>

</body>
</html>